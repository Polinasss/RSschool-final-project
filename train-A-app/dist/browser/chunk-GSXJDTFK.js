import{c as y,d as O}from"./chunk-I6WBTFIN.js";import{b as I,d as p,f as k,g as R,k as N,n as T,p as j,s as q,t as V,u as D}from"./chunk-PDIALKXB.js";import{Z as z,aa as H}from"./chunk-WBXFGMZG.js";import{a as F}from"./chunk-PMXBU2MZ.js";import{r as M}from"./chunk-P6FRCD3I.js";import{Ib as f,Kb as v,Mb as g,Pb as u,Ub as s,Vb as a,Wb as _,dc as P,fc as h,i as b,ob as o,pb as c,pc as l,qc as w,rc as E,xc as S,za as C}from"./chunk-LLXA3JIY.js";function W(r,m){if(r&1&&(s(0,"p",5),l(1),a()),r&2){let d=h();o(),w(d.getErrorMessage("email"))}}function A(r,m){if(r&1&&(s(0,"p",5),l(1),a()),r&2){let d=h();o(),w(d.getErrorMessage("password"))}}function B(r,m){r&1&&(s(0,"p",5),l(1,"Passwords do not match"),a())}function G(r,m){if(r&1&&(s(0,"p",5),l(1),a()),r&2){let d=h();o(),E("Unknown server error: ",d.signupForm.errors==null?null:d.signupForm.errors.serverError,"")}}var oe=(()=>{let m=class m{constructor(i,e,t){this.fb=i,this.router=e,this.http=t,this.signupStatus=!1,this.isSubmitting=!1,this.formWasFilled=!1,this.subscriptions=new b,this.errorsHandler={invalidFields:n=>{this.email?.setErrors({serverError:n}),this.password?.setErrors({serverError:n}),this.repeatPassword?.setErrors({serverError:n})},invalidEmail:n=>{this.email?.setErrors({serverError:n})},invalidPassword:n=>{this.password?.setErrors({serverError:n})},invalidUniqueKey:()=>{this.email?.setErrors({serverError:"Account with this email already exists"})}},this.signupForm=this.fb.group({email:["",[p.required,p.pattern(/^[\w\d_]+@[\w\d_]+.\w{2,7}$/)]],password:["",[p.required,p.minLength(8),p.pattern(/^\S*$/)]],repeatPassword:["",[p.required]]},{validators:[this.passwordsValidator]})}passwordsValidator(i){let{value:e}=i.controls.password,{value:t}=i.controls.repeatPassword;return e===t?null:{passwordNotMatch:!0}}get email(){return this.signupForm.get("email")}get password(){return this.signupForm.get("password")}get repeatPassword(){return this.signupForm.get("repeatPassword")}onSubmit(){if(this.signupForm.valid){this.isSubmitting=!0;let{email:i,password:e}=this.signupForm.getRawValue(),t=this.http.post("/api/signup/",{email:i,password:e}).subscribe({next:()=>{this.router.navigate(["/signin"])},error:n=>{let x=Object.keys(this.errorsHandler).find(L=>L===n.error.reason);x?this.errorsHandler[x](n.error.message):this.signupForm.setErrors({serverError:n.message}),this.isSubmitting=!1},complete:()=>{this.isSubmitting=!1}});this.subscriptions.add(t)}this.formWasFilled=!0}isControlInvalid(i){let e=this.signupForm.get(i);return e?e.invalid&&e.touched:!1}get isRepeatPassInvalid(){return this.signupForm.errors?.passwordNotMatch&&this.signupForm.controls.repeatPassword.value.length>0}get disabledForm(){return this.signupForm.invalid||this.isSubmitting}get unknownServerError(){return this.signupForm.errors?.serverError}getErrorMessage(i){let e=this.signupForm.get(i)?.errors;if(e){if(e.required)switch(i){case"email":return"Please enter a email";case"password":return"Please enter a password";default:return"This field is required"}if(e.pattern)return"Email is not valid";if(e.minlength)return`The ${i} is too short`;if(e.serverError)return e.serverError}return""}ngOnDestroy(){this.subscriptions.unsubscribe()}};m.\u0275fac=function(e){return new(e||m)(c(q),c(y),c(F))},m.\u0275cmp=C({type:m,selectors:[["app-signup"]],standalone:!0,features:[S],decls:22,vars:12,consts:[[1,"signup"],[1,"form__title"],[1,"form",3,"ngSubmit","formGroup"],["for","email",1,"form__label"],["id","email","formControlName","email","type","text",1,"form__input"],[1,"form__error"],["for","password",1,"form__label"],["id","password","formControlName","password","type","password",1,"form__input"],["for","repeatPassword",1,"form__label"],["id","repeatPassword","formControlName","repeatPassword","type","password",1,"form__input"],[1,"form__controls"],["mat-flat-button","","type","submit",3,"disabled"],["routerLink","/signin","routerLinkActive","active",1,"form__link"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"h2",1),l(2,"Sign Up"),a(),s(3,"form",2),P("ngSubmit",function(){return t.onSubmit()}),s(4,"label",3),l(5,"Email"),a(),_(6,"input",4),f(7,W,2,1,"p",5),s(8,"label",6),l(9,"Password"),a(),_(10,"input",7),f(11,A,2,1,"p",5),s(12,"label",8),l(13,"Repeat password"),a(),_(14,"input",9),f(15,B,2,0,"p",5)(16,G,2,1,"p",5),s(17,"div",10)(18,"button",11),l(19,"Register"),a(),s(20,"a",12),l(21,"Sign In"),a()()()()),e&2&&(o(3),v("formGroup",t.signupForm),o(3),g("form__input--error",t.isControlInvalid("email")),o(),u(t.isControlInvalid("email")&&t.formWasFilled?7:-1),o(3),g("form__input--error",t.isControlInvalid("password")),o(),u(t.isControlInvalid("password")&&t.formWasFilled?11:-1),o(3),g("form__input--error",t.isRepeatPassInvalid),o(),u(t.isRepeatPassInvalid?15:-1),o(),u(t.unknownServerError?16:-1),o(2),v("disabled",t.disabledForm))},dependencies:[O,V,N,I,k,R,D,T,j,H,z,M],styles:[".form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:.9375rem 1.25rem 1.75rem;background-color:#fff;border-radius:5px;box-shadow:2px 2px 2px 1px #828282;width:400px}.form__title[_ngcontent-%COMP%]{font-size:2.5rem;line-height:1.125rem;font-weight:700;margin:2.5rem 0}.form__label[_ngcontent-%COMP%]{margin-left:.625rem;margin-top:1.25rem;font-size:1rem;font-weight:700}.form__field[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form__input[_ngcontent-%COMP%]{appearance:none;border:none;outline:none;border-bottom:2px solid #2169c1;background:#2169c133;border-radius:2px 2px 0 0;padding:.625rem;margin-bottom:.625rem;color:#2169c1}.form__input--error[_ngcontent-%COMP%]{border-bottom:2px solid #ba1a1a}.form__input[_ngcontent-%COMP%]::placeholder{font-size:12px;color:#828282}.form__input-small[_ngcontent-%COMP%]{width:110px}.form__controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;margin-top:20px;gap:8px}.form__link[_ngcontent-%COMP%]{text-decoration:none;color:#2169c1}.form__link[_ngcontent-%COMP%]:hover{color:#000}.form__group[_ngcontent-%COMP%]{width:380px;border-radius:5px;border:1px solid #828282;padding:10px;margin-bottom:20px}.form__tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px}.form__icon[_ngcontent-%COMP%]{cursor:pointer}.form__error[_ngcontent-%COMP%]{font-size:.75rem;line-height:.75rem;color:#ba1a1a}.form__error-container[_ngcontent-%COMP%]{min-height:20px}@media (max-width: 425px){.form[_ngcontent-%COMP%]{width:300px}}@media (max-width: 320px){.form[_ngcontent-%COMP%]{width:260px}}.signup[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}"]});let r=m;return r})();export{oe as SignupComponent};
