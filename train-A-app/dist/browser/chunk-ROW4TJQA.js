import{a as D,b as Y}from"./chunk-ZJDSQNAS.js";import{a as ae}from"./chunk-XIXW3NB4.js";import{c as re}from"./chunk-I6WBTFIN.js";import{a as ge,b as he,c as Ce,d as Ee,e as Pe,f as be,g as Me,h as xe}from"./chunk-MU6QX773.js";import{b as I,c as T}from"./chunk-TMKB5IXM.js";import{b as H,g as O,h as S}from"./chunk-A2J7V4S5.js";import{a as fe,c as pe,d as _e}from"./chunk-5GEB22Y5.js";import{a as P,b as J}from"./chunk-SWG7LFT6.js";import{b as ue}from"./chunk-GHIUHDLH.js";import"./chunk-EZOB3TJ4.js";import"./chunk-7CFUQ7C3.js";import"./chunk-RGNDWIHZ.js";import{q as G}from"./chunk-MGBRLVRV.js";import{b as F,d as k,f as y,g as L,j as me,k as B,n as q,p as W,s as le,t as E,u as N}from"./chunk-PDIALKXB.js";import{$ as de,Z as se,aa as ce}from"./chunk-WBXFGMZG.js";import"./chunk-PMXBU2MZ.js";import{m as z,r as v}from"./chunk-P6FRCD3I.js";import{Hc as A,Ib as h,Ka as b,Kb as d,La as M,Ta as j,Ub as i,Vb as n,Wb as R,_b as x,a as Q,b as X,dc as u,fc as f,ga as U,n as ee,na as te,ob as s,oc as $,pb as V,pc as l,qc as w,ta as _,tc as ie,uc as ne,vc as oe,xc as C,za as g}from"./chunk-LLXA3JIY.js";var we=(()=>{let t=class t{constructor(){this.store=_(G),this.user$=this.store.select(Y.selectUser),this.error$=this.store.select(Y.selectError)}loadUserProfile(){this.store.dispatch(D.loadUserProfile())}updateUserProfile(r){this.store.dispatch(D.updateUserProfile({user:r}))}updateUserProfilePassword(r){this.store.dispatch(D.updateUserProfilePassword({password:r}))}logoutUserProfile(){this.store.dispatch(D.logoutUserProfile())}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=te({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var ye=(()=>{let t=class t{constructor(){this.dialogRef=_(ge),this.data=_(he),this.newPassword=""}onSaveNewPassword(){this.newPassword=this.data.password}onClose(){this.dialogRef.close()}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=g({type:t,selectors:[["app-change-password-dialog"]],standalone:!0,features:[C],decls:16,vars:2,consts:[[1,"dialog"],["mat-dialog-title","",1,"dialog__title"],["mat-icon-button","",1,"dialog__close-btn",3,"click"],[1,"dialog__content"],[1,"dialog__content__title"],["appearance","outline",1,"dialog__content__input","small"],["matInput","","type","text",3,"ngModelChange","ngModel"],[1,"dialog__actions"],["mat-flat-button","","cdkFocusInitial","",1,"dialog__actions__save-btn",3,"click","mat-dialog-close"]],template:function(o,a){o&1&&(i(0,"div",0)(1,"h2",1)(2,"mat-icon"),l(3,"lock"),n(),l(4,"Change Password"),n(),i(5,"button",2),u("click",function(){return a.onClose()}),i(6,"mat-icon"),l(7,"close"),n()(),i(8,"mat-dialog-content",3)(9,"p",4),l(10,"New Password"),n(),i(11,"mat-form-field",5)(12,"input",6),oe("ngModelChange",function(p){return ne(a.newPassword,p)||(a.newPassword=p),p}),n()()(),i(13,"mat-dialog-actions",7)(14,"button",8),u("click",function(){return a.onSaveNewPassword()}),l(15," Save "),n()()()),o&2&&(s(12),ie("ngModel",a.newPassword),s(2),d("mat-dialog-close",a.newPassword))},dependencies:[xe,Ee,Pe,Me,be,ce,se,de,S,O,T,I,J,P,E,F,y,me],styles:[".mdc-text-field--filled{background-color:#007bff!important;border-radius:.25rem!important}  .mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:#000!important;letter-spacing:.025rem}[_ngcontent-%COMP%]:ng-deep   .mdc-text-field--filled[_ngcontent-%COMP%]   .mdc-line-ripple[_ngcontent-%COMP%]{display:none}  .mdc-text-field--filled.mdc-text-field--invalid{border:1px solid #ba1a1a!important}  .mat-mdc-form-fieldn:not(.mat-form-field-invalid) .mat-mdc-form-field-subscript-wrapper{height:0rem}  .mat-form-field{font-size:.75rem}mat-form-field.small[_ngcontent-%COMP%]{--mat-form-field-container-height: 2.19rem;--mat-form-field-container-vertical-padding: .13rem}.dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:20rem;padding:1rem 0;position:relative}.dialog__title[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-start;align-items:center;gap:.5rem;font-weight:700}.dialog__title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2169c1}.dialog__close-btn[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:.5rem;color:#828282}.dialog__content[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center}.dialog__content__title[_ngcontent-%COMP%]{font-weight:700}.dialog__content__input[_ngcontent-%COMP%]{width:100%}.dialog__actions[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center}.dialog__actions__save-btn[_ngcontent-%COMP%]{width:100%;height:2.5rem;border-radius:.5rem;cursor:pointer;box-shadow:0 4px 4px #0000004d}"]});let e=t;return e})();function Te(e,t){e&1&&(i(0,"span"),l(1,"Please enter a new user name"),n())}function ke(e,t){e&1&&(i(0,"span"),l(1,"Name must be at least 3 characters long"),n())}function De(e,t){if(e&1&&(i(0,"mat-error",7),h(1,Te,2,0,"span",8)(2,ke,2,0,"span",8),n()),e&2){let m=f(2);s(),d("ngIf",m.userNameControl==null||m.userNameControl.errors==null?null:m.userNameControl.errors.required),s(),d("ngIf",m.userNameControl==null||m.userNameControl.errors==null?null:m.userNameControl.errors.minlength)}}function Ue(e,t){if(e&1&&(i(0,"mat-form-field",4),R(1,"input",5),h(2,De,3,2,"mat-error",6),n()),e&2){let m=f();s(2),d("ngIf",m.userNameControl==null?null:m.userNameControl.invalid)}}function je(e,t){if(e&1){let m=x();i(0,"p",9),l(1),n(),i(2,"button",10),u("click",function(){b(m);let o=f();return M(o.onEditName())}),i(3,"mat-icon"),l(4,"edit"),n()()}if(e&2){let m=f();s(),w(m.userName)}}function Ve(e,t){e&1&&(i(0,"button",11)(1,"mat-icon"),l(2,"save"),n()())}var Ne=(()=>{let t=class t{constructor(){this.nameChanged=new j,this.isEditingName=!1}get userNameControl(){return this.userNameForm.get("userName")}onEditName(){this.isEditingName=!this.isEditingName,this.userNameForm.patchValue({userName:this.userName})}onSubmit(){if(this.userNameForm.valid){let{userName:r}=this.userNameForm.value;this.nameChanged.emit(r),this.isEditingName=!this.isEditingName}}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=g({type:t,selectors:[["app-edit-name-form"]],inputs:{userNameForm:"userNameForm",userName:"userName"},outputs:{nameChanged:"nameChanged"},standalone:!0,features:[C],decls:5,vars:4,consts:[["viewName",""],[1,"user-profile__name",3,"ngSubmit","formGroup"],["class","small","appearance","outline",4,"ngIf","ngIfElse"],["mat-button","","class","user-profile__name__save-btn","type","submit",4,"ngIf"],["appearance","outline",1,"small"],["matInput","","type","text","formControlName","userName"],["class","hint",4,"ngIf"],[1,"hint"],[4,"ngIf"],[1,"user-profile__name__text"],["mat-icon-button","","type","button",1,"user-profile__name__edit-btn",3,"click"],["mat-button","","type","submit",1,"user-profile__name__save-btn"]],template:function(o,a){if(o&1){let c=x();i(0,"form",1),u("ngSubmit",function(){return b(c),M(a.onSubmit())}),h(1,Ue,3,1,"mat-form-field",2)(2,je,5,1,"ng-template",null,0,A)(4,Ve,3,0,"button",3),n()}if(o&2){let c=$(3);d("formGroup",a.userNameForm),s(),d("ngIf",a.isEditingName)("ngIfElse",c),s(3),d("ngIf",a.isEditingName)}},dependencies:[P,S,O,H,T,I,E,B,F,y,L,N,q,W,v,z],styles:[".mdc-text-field--filled{background-color:#007bff!important;border-radius:.25rem!important}  .mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:#000!important;letter-spacing:.025rem}[_ngcontent-%COMP%]:ng-deep   .mdc-text-field--filled[_ngcontent-%COMP%]   .mdc-line-ripple[_ngcontent-%COMP%]{display:none}  .mdc-text-field--filled.mdc-text-field--invalid{border:1px solid #ba1a1a!important}  .mat-mdc-form-fieldn:not(.mat-form-field-invalid) .mat-mdc-form-field-subscript-wrapper{height:0rem}  .mat-form-field{font-size:.75rem}mat-form-field.small[_ngcontent-%COMP%]{--mat-form-field-container-height: 2.19rem;--mat-form-field-container-vertical-padding: .13rem}.user-profile__name[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.user-profile__name[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{width:90%}.user-profile__name[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   mat-error[_ngcontent-%COMP%]{margin-left:-.93rem;margin-top:-.2rem;font-size:.625rem}.user-profile__name__edit-btn[_ngcontent-%COMP%], .user-profile__name__save-btn[_ngcontent-%COMP%]{height:2.19rem;border:none;background:none;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0}.user-profile__name__edit-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .user-profile__name__save-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-top:-1.25rem;font-size:1.5rem;color:#2169c1}"]});let e=t;return e})();function Re(e,t){e&1&&(i(0,"span"),l(1,"Please enter a new user email"),n())}function $e(e,t){e&1&&(i(0,"span"),l(1,"The user email is invalid. Example: user@mail.com"),n())}function Ae(e,t){if(e&1&&(i(0,"mat-error",7),h(1,Re,2,0,"span",8)(2,$e,2,0,"span",8),n()),e&2){let m=f(2);s(),d("ngIf",m.userEmailControl==null||m.userEmailControl.errors==null?null:m.userEmailControl.errors.required),s(),d("ngIf",m.userEmailControl==null||m.userEmailControl.errors==null?null:m.userEmailControl.errors.email)}}function ze(e,t){if(e&1&&(i(0,"mat-form-field",4),R(1,"input",5),h(2,Ae,3,2,"mat-error",6),n()),e&2){let m=f();s(2),d("ngIf",m.userEmailControl==null?null:m.userEmailControl.invalid)}}function Ge(e,t){if(e&1){let m=x();i(0,"p",9),l(1),n(),i(2,"button",10),u("click",function(){b(m);let o=f();return M(o.onEditEmail())}),i(3,"mat-icon"),l(4,"edit"),n()()}if(e&2){let m=f();s(),w(m.userEmail)}}function Le(e,t){e&1&&(i(0,"button",11)(1,"mat-icon"),l(2,"save"),n()())}var Oe=(()=>{let t=class t{constructor(){this.emailChanged=new j,this.isEditingEmail=!1}get userEmailControl(){return this.userEmailForm.get("userEmail")}onEditEmail(){this.isEditingEmail=!this.isEditingEmail,this.userEmailForm.patchValue({userEmail:this.userEmail})}onSubmit(){if(this.userEmailForm.valid){let{userEmail:r}=this.userEmailForm.value;this.emailChanged.emit(r),this.isEditingEmail=!this.isEditingEmail}}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=g({type:t,selectors:[["app-edit-email-form"]],inputs:{userEmailForm:"userEmailForm",userEmail:"userEmail"},outputs:{emailChanged:"emailChanged"},standalone:!0,features:[C],decls:5,vars:4,consts:[["viewEmail",""],[1,"user-profile__email",3,"ngSubmit","formGroup"],["class","small","appearance","outline",4,"ngIf","ngIfElse"],["mat-icon-button","","class","user-profile__email__save-btn","type","submit",4,"ngIf"],["appearance","outline",1,"small"],["matInput","","type","text","formControlName","userEmail"],["class","hint",4,"ngIf"],[1,"hint"],[4,"ngIf"],[1,"user-profile__email__text"],["mat-button","","type","button",1,"user-profile__email__edit-btn",3,"click"],["mat-icon-button","","type","submit",1,"user-profile__email__save-btn"]],template:function(o,a){if(o&1){let c=x();i(0,"form",1),u("ngSubmit",function(){return b(c),M(a.onSubmit())}),h(1,ze,3,1,"mat-form-field",2)(2,Ge,5,1,"ng-template",null,0,A)(4,Le,3,0,"button",3),n()}if(o&2){let c=$(3);d("formGroup",a.userEmailForm),s(),d("ngIf",a.isEditingEmail)("ngIfElse",c),s(3),d("ngIf",a.isEditingEmail)}},dependencies:[P,S,O,H,T,I,E,B,F,y,L,N,q,W,v,z],styles:[".mdc-text-field--filled{background-color:#007bff!important;border-radius:.25rem!important}  .mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:#000!important;letter-spacing:.025rem}[_ngcontent-%COMP%]:ng-deep   .mdc-text-field--filled[_ngcontent-%COMP%]   .mdc-line-ripple[_ngcontent-%COMP%]{display:none}  .mdc-text-field--filled.mdc-text-field--invalid{border:1px solid #ba1a1a!important}  .mat-mdc-form-fieldn:not(.mat-form-field-invalid) .mat-mdc-form-field-subscript-wrapper{height:0rem}  .mat-form-field{font-size:.75rem}mat-form-field.small[_ngcontent-%COMP%]{--mat-form-field-container-height: 2.19rem;--mat-form-field-container-vertical-padding: .13rem}.user-profile__email[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.user-profile__email[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{width:90%}.user-profile__email[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]   mat-error[_ngcontent-%COMP%]{margin-left:.93rem;margin-top:-.2rem;font-size:.625rem}.user-profile__email__edit-btn[_ngcontent-%COMP%], .user-profile__email__save-btn[_ngcontent-%COMP%]{height:2.19rem;border:none;background:none;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:0}.user-profile__email__edit-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .user-profile__email__save-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-top:-1.25rem;font-size:1.5rem;color:#2169c1}"]});let e=t;return e})();var Lt=(()=>{let t=class t{constructor(r,o,a){this.fb=r,this.notificationService=o,this.router=a,this.userProfileFacade=_(we),this.userProfile$=this.userProfileFacade.user$,this.error$=this.userProfileFacade.error$,this.destroy$=new ee,this.userProfile={name:"",email:"",role:""},this.dialog=_(Ce),this.userPassword="",this.store=_(G),this.userNameForm=this.fb.group({userName:[this.userProfile.name,[k.required,k.minLength(3)]]}),this.userEmailForm=this.fb.group({userEmail:[this.userProfile.email,[k.required,k.email]]})}ngOnInit(){this.userProfileFacade.loadUserProfile(),this.error$.pipe(U(this.destroy$)).subscribe(r=>{r&&this.notificationService.openFailureSnackBar(r)}),this.userProfile$.pipe(U(this.destroy$)).subscribe(r=>{this.userProfile=r})}onNameChanged(r){let o=X(Q({},this.userProfile),{name:r});this.userProfileFacade.updateUserProfile(o)}onEmailChanged(r){let o=X(Q({},this.userProfile),{email:r});this.userProfileFacade.updateUserProfile(o)}onChangePasswordDialog(){this.dialog.open(ye,{data:{password:this.userPassword}}).afterClosed().pipe(U(this.destroy$)).subscribe(o=>{o!==void 0&&(this.userPassword=o,this.userProfileFacade.updateUserProfilePassword({password:this.userPassword}))})}onLogout(){this.userProfileFacade.logoutUserProfile(),this.store.dispatch(ae.changeRole({role:"guest"})),this.router.navigate(["home"])}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};t.\u0275fac=function(o){return new(o||t)(V(le),V(ue),V(re))},t.\u0275cmp=g({type:t,selectors:[["app-user-profile-page"]],standalone:!0,features:[C],decls:18,vars:5,consts:[[1,"user-profile"],[1,"user-profile__header"],[1,"user-profile__content"],[1,"user-profile__content__role"],["mat-flat-button","","type","button",1,"user-profile__content__change-btn","edit-btn",3,"click"],[1,"user-profile__content__text-title"],[3,"nameChanged","userNameForm","userName"],[3,"emailChanged","userEmailForm","userEmail"],["mat-flat-button","","type","button",1,"user-profile__content__logout-btn",3,"click"]],template:function(o,a){o&1&&(i(0,"mat-card",0)(1,"mat-card-header",1)(2,"mat-icon"),l(3,"account_circle"),n(),l(4,"Profile"),n(),i(5,"mat-card-content",2)(6,"p",3),l(7),n(),i(8,"button",4),u("click",function(){return a.onChangePasswordDialog()}),l(9," Change password "),n(),i(10,"p",5),l(11,"Name:"),n(),i(12,"app-edit-name-form",6),u("nameChanged",function(p){return a.onNameChanged(p)}),n(),i(13,"p",5),l(14,"Email:"),n(),i(15,"app-edit-email-form",7),u("emailChanged",function(p){return a.onEmailChanged(p)}),n(),i(16,"button",8),u("click",function(){return a.onLogout()}),l(17," Logout "),n()()()),o&2&&(s(7),w(a.userProfile.role),s(5),d("userNameForm",a.userNameForm)("userName",a.userProfile.name),s(3),d("userEmailForm",a.userEmailForm)("userEmail",a.userProfile.email))},dependencies:[fe,_e,pe,J,P,E,N,v,Ne,Oe],styles:[".user-profile[_ngcontent-%COMP%]{margin:1.25rem auto;padding:1.25rem 2.5rem;width:37.5rem;display:flex;flex-direction:column;align-items:center;justify-content:center}.user-profile__header[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-bottom:.625rem;display:flex;align-items:center;justify-content:center;gap:.5rem}.user-profile__header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#2169c1;font-size:1.5rem}.user-profile__content[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;padding-bottom:0}.user-profile__content__change-btn[_ngcontent-%COMP%], .user-profile__content__logout-btn[_ngcontent-%COMP%]{margin-top:1rem;height:2.5rem;border:none;border-radius:.5rem;font-weight:700;color:#fff;cursor:pointer;box-shadow:0 4px 4px #0000004d}.user-profile__content__change-btn[_ngcontent-%COMP%]{margin-left:auto;width:9.38rem;background-color:#2169c1}.user-profile__content__logout-btn[_ngcontent-%COMP%]{margin-right:auto;width:6.25rem;background-color:#ba1a1a}.user-profile__content__role[_ngcontent-%COMP%]{margin-left:auto;font-weight:700}.user-profile__content__text-title[_ngcontent-%COMP%]{font-weight:700}"]});let e=t;return e})();export{Lt as UserProfilePageComponent};
