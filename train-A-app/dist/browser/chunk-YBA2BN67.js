import{a as Fe,b as Ie}from"./chunk-CB3TRM6G.js";import{a as Me}from"./chunk-RIKPSUBX.js";import{a as E}from"./chunk-O4VMZ2NP.js";import{a as Se,b as ye}from"./chunk-VZCW3W3G.js";import{a as we,b as Ce}from"./chunk-5GEB22Y5.js";import{a as be}from"./chunk-SWG7LFT6.js";import{b as ce,d as x,f as de,g as pe,k as me,l as ge,n as he,p as fe,s as ue,u as _e}from"./chunk-PDIALKXB.js";import{G as B,N as L,Z as xe,aa as ve}from"./chunk-WBXFGMZG.js";import{k as oe,l as P,m as C,n as se,o as le,r as O}from"./chunk-P6FRCD3I.js";import{Aa as q,Bc as ne,Cc as v,Dc as S,Hc as ae,Ib as d,Ja as W,Ka as Z,Kb as l,La as J,Lb as R,Ub as o,Vb as a,Wb as m,Xb as K,Yb as X,Zb as Y,_b as ee,a as U,dc as w,fc as f,ga as F,gc as j,hc as N,i as G,jc as te,kc as H,lc as A,n as D,na as V,oa as Q,ob as s,oc as ie,pc as g,qc as re,rc as T,ta as _,xc as u,z,za as h}from"./chunk-LLXA3JIY.js";var De=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=q({type:e}),e.\u0275inj=Q({imports:[L,B,L,B]});let t=e;return t})();var b=(()=>{let e=class e{constructor(){this.panelStateSubject=new D,this.panelState$=this.panelStateSubject.asObservable()}togglePanel(n,r){this.panelStateSubject.next({panelId:n,editMode:r})}togglePanelAndUpdateItem(n,r,i){this.panelStateSubject.next({panelId:n,editMode:r,carriage:i})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var $e=(t,e,c,n)=>({left:t,right:e,selected:c,unavailable:n}),Te=(()=>{let e=class e{constructor(){this.isDisabled=!1}toggleSelectedSeat(){this.seat.isAvailable&&(this.seat.selected=!this.seat.selected)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=h({type:e,selectors:[["app-seat"]],inputs:{seat:"seat",isDisabled:"isDisabled"},standalone:!0,features:[u],decls:2,vars:8,consts:[[1,"seat",3,"click","ngClass","disabled"]],template:function(r,i){r&1&&(o(0,"button",0),w("click",function(){return i.toggleSelectedSeat()}),g(1),a()),r&2&&(l("ngClass",ne(3,$e,i.seat.position==="left",i.seat.position==="right",i.seat.selected,!i.seat.isAvailable))("disabled",i.isDisabled),s(),T(" ",i.seat.seatNumber,`
`))},dependencies:[oe],styles:[".seat[_ngcontent-%COMP%]{width:30px;height:30px;margin:5px;display:flex;align-items:center;justify-content:center;border-radius:5px;background-color:#2169c1;color:#fff;box-shadow:1px 1px 1px 1px #ccc;cursor:pointer;outline:none;border:none}.selected[_ngcontent-%COMP%]{background-color:orange}.unavailable[_ngcontent-%COMP%]{background-color:#828282;cursor:not-allowed}.seat[_ngcontent-%COMP%]:disabled{cursor:not-allowed}"]});let t=e;return t})();function ke(t,e){if(t&1&&m(0,"app-seat",7),t&2){let c=e.$implicit,n=f(3);l("seat",c)("isDisabled",n.isDisabled)}}function ze(t,e){if(t&1&&(o(0,"div"),d(1,ke,1,2,"app-seat",6),a()),t&2){let c=e.$implicit;s(),l("ngForOf",c)}}function Re(t,e){if(t&1&&m(0,"app-seat",7),t&2){let c=e.$implicit,n=f(3);l("seat",c)("isDisabled",n.isDisabled)}}function je(t,e){if(t&1&&(o(0,"div"),d(1,Re,1,2,"app-seat",6),a()),t&2){let c=e.$implicit;s(),l("ngForOf",c)}}function Ne(t,e){if(t&1&&(o(0,"div",1)(1,"div",2),d(2,ze,2,1,"div",3),a(),m(3,"div",4),o(4,"div",5),d(5,je,2,1,"div",3),a()()),t&2){let c=f();s(),R("--columns",c.numberOfRows),s(),l("ngForOf",c.rightSeatsInRows),s(2),R("--columns",c.numberOfRows),s(),l("ngForOf",c.leftSeatsInRows)}}var $=(()=>{let e=class e{constructor(){this.isDisabled=!1,this.leftSeats=[],this.rightSeats=[],this.leftSeatsInRows=[],this.rightSeatsInRows=[],this.numberOfRows=0}ngOnChanges(n){n.carriage&&this.carriage&&this.initializeSeats()}initializeSeats(){let{rows:n,leftSeats:r,rightSeats:i}=this.carriage;this.numberOfRows=Number(n),this.leftSeats=[],this.rightSeats=[],this.generateSeats(this.numberOfRows,Number(r),Number(i)),this.leftSeatsInRows=this.distributeSeats(this.leftSeats,Number(r)),this.rightSeatsInRows=this.distributeSeats(this.rightSeats,Number(i))}generateSeats(n,r,i,p=!0){let y=1;for(let I=0;I<n;I+=1)for(let k=0;k<r+i;k+=1)k<r?this.leftSeats.push({seatNumber:y,position:"left",isAvailable:p,selected:!1}):this.rightSeats.push({seatNumber:y,position:"right",isAvailable:p,selected:!1}),y+=1}distributeSeats(n,r){let i=[];for(let p=0;p<n.length;p+=r){let y=n.slice(p,p+r);i.push(y.reverse())}return i}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=h({type:e,selectors:[["app-carriage-schema"]],inputs:{carriage:"carriage",isDisabled:"isDisabled"},standalone:!0,features:[W,u],decls:1,vars:1,consts:[["class","carriage__schema schema",4,"ngIf"],[1,"carriage__schema","schema"],[1,"schema__right"],[4,"ngFor","ngForOf"],[1,"schema__aisle"],[1,"schema__left"],[3,"seat","isDisabled",4,"ngFor","ngForOf"],[3,"seat","isDisabled"]],template:function(r,i){r&1&&d(0,Ne,6,6,"div",0),r&2&&l("ngIf",i.carriage)},dependencies:[Te,P,C],styles:[".schema[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;max-width:1100px;max-height:800px;margin-bottom:30px;border:1px solid #cccccc;box-shadow:2px 2px 2px 2px #ccc;border-radius:10px;overflow:auto}.schema__right[_ngcontent-%COMP%], .schema__left[_ngcontent-%COMP%]{display:inline-grid;grid-template-columns:repeat(var(--columns, 1),1fr);margin:10px 40px;padding:5px;gap:5px;border-radius:5px;border-left:1px solid #cccccc;border-right:1px solid #cccccc}@media (max-width: 1024px){.schema[_ngcontent-%COMP%]{max-width:750px}}@media (max-width: 425px){.schema[_ngcontent-%COMP%]{max-width:300px}}@media (max-width: 320px){.schema[_ngcontent-%COMP%]{max-width:200px}}"]});let t=e;return t})();function He(t,e){if(t&1&&(o(0,"div",5),m(1,"app-carriage-schema",6),a()),t&2){let c=f();s(),l("carriage",c.carriageData)("isDisabled",!0)}}var Pe=(()=>{let e=class e{constructor(){this.panelService=_(b)}ngOnInit(){this.item&&(this.carriageData={name:this.item.name,rows:String(this.item.rows),leftSeats:String(this.item.leftSeats),rightSeats:String(this.item.rightSeats)})}onUpdate(){this.panelService.togglePanelAndUpdateItem("panel","edit",this.item)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=h({type:e,selectors:[["app-carriages-item"]],inputs:{item:"item"},standalone:!0,features:[u],decls:6,vars:2,consts:[[1,"item"],[1,"item__header"],[1,"item__header-title"],["aria-hidden","false","aria-label","Edit Icon","fontIcon","edit",1,"item__icon",3,"click"],["class","item__schema",4,"ngIf"],[1,"item__schema"],[3,"carriage","isDisabled"]],template:function(r,i){r&1&&(o(0,"mat-card",0)(1,"div",1)(2,"mat-card-title",2),g(3),a(),o(4,"mat-icon",3),w("click",function(){return i.onUpdate()}),a()(),d(5,He,2,2,"div",4),a()),r&2&&(s(3),T(" ",i.item.name,""),s(2),l("ngIf",i.carriageData))},dependencies:[O,C,$,we,Ce,be,De],styles:[".item[_ngcontent-%COMP%]{margin-top:40px;display:flex;flex-direction:column;box-shadow:1px 1px 1px 1px #ccc}.item__header[_ngcontent-%COMP%]{display:flex;padding:15px 30px;justify-content:space-between}.item__header-title[_ngcontent-%COMP%]{font-size:24px;font-weight:600}.item__icon[_ngcontent-%COMP%]{color:#000;cursor:pointer}.item__schema[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]});let t=e;return t})();function Ae(t,e){t&1&&(o(0,"p",11),g(1," The carriage with this name already exists "),a())}function Be(t,e){t&1&&(o(0,"p",11),g(1," max 50 rows "),a())}function Le(t,e){t&1&&(o(0,"p",11),g(1," max 5 seats "),a())}function Ue(t,e){t&1&&(o(0,"p",11),g(1," max 5 seats "),a())}function Ge(t,e){if(t&1&&m(0,"app-carriage-schema",12),t&2){let c=f();l("carriage",c.carriageData)("isDisabled",!0)}}var Oe=(()=>{let e=class e{constructor(){this.fb=_(ue),this.carriageFacade=_(E),this.panelService=_(b),this.destroy$=new D,this.editMode="create"}ngOnInit(){this.isDuplicateName=!1,this.carriageForm=this.fb.nonNullable.group({name:["",x.required],rows:["",[x.required,x.min(1),x.max(50)]],leftSeats:["",[x.required,x.min(1),x.max(5)]],rightSeats:["",[x.required,x.min(1),x.max(5)]]}),this.carriageForm.get("name")?.valueChanges.pipe(F(this.destroy$)).subscribe(()=>{this.isDuplicateName=!1}),this.carriageForm.valueChanges.pipe(F(this.destroy$)).subscribe(()=>{this.carriageForm.valid&&(this.isDuplicateName=!1,this.updateCarriageData())})}ngAfterViewInit(){this.panelService.panelState$.pipe(F(this.destroy$)).subscribe(n=>{n.panelId==="panel"&&(this.editMode=n.editMode??"create",this.carriageForUpdating=n.carriage??null,this.editMode&&this.carriageForUpdating?this.updateFormValues():this.carriageForm.reset())})}get rows(){return this.carriageForm.get("rows")}get leftSeats(){return this.carriageForm.get("leftSeats")}get rightSeats(){return this.carriageForm.get("rightSeats")}updateCarriageData(){this.carriageData={name:this.carriageForm.get("name")?.value||"",rows:this.carriageForm.get("rows")?.value?.toString()||"",leftSeats:this.carriageForm.get("leftSeats")?.value?.toString()||"",rightSeats:this.carriageForm.get("rightSeats")?.value?.toString()||""}}updateFormValues(){this.carriageForUpdating&&this.carriageForm.setValue({name:this.carriageForUpdating.name,rows:this.carriageForUpdating.rows.toString(),leftSeats:this.carriageForUpdating.leftSeats.toString(),rightSeats:this.carriageForUpdating.rightSeats.toString()})}closeFormPanel(){this.carriageForm.reset(),this.panelService.togglePanel("panel","save")}onSave(){if(this.carriageForm.valid){let n={name:this.carriageForm.get("name")?.value||"",rows:Number(this.carriageForm.get("rows")?.value),leftSeats:Number(this.carriageForm.get("leftSeats")?.value),rightSeats:Number(this.carriageForm.get("rightSeats")?.value)};this.editMode==="edit"?this.carriageFacade.carriage$.pipe(F(this.destroy$),z(r=>r.filter(i=>i.code!==this.carriageForUpdating?.code).some(i=>i.name===n.name))).subscribe(r=>{r?this.isDuplicateName=!0:this.carriageForUpdating&&(this.carriageFacade.updateCarriage(U({code:this.carriageForUpdating?.code},n)),this.closeFormPanel())}):this.carriageFacade.carriage$.pipe(F(this.destroy$),z(r=>r.some(i=>i.name===n.name))).subscribe(r=>{r?this.isDuplicateName=!0:(this.carriageFacade.addCarriage(n),this.closeFormPanel())})}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=h({type:e,selectors:[["app-carriages-form"]],inputs:{editMode:"editMode",carriageForUpdating:"carriageForUpdating"},standalone:!0,features:[u],decls:29,vars:7,consts:[[1,"carriage__form",3,"formGroup"],[1,"carriage__form__field"],[1,"form__label"],["formControlName","name",1,"form__input"],[1,"form__error-container"],["class","form__error",4,"ngIf"],["type","number","formControlName","rows","placeholder","*max 50 rows",1,"form__input","carriage__input"],["type","number","formControlName","leftSeats","placeholder","*max 5 seats",1,"form__input"],["type","number","formControlName","rightSeats","placeholder","*max 5 seats",1,"form__input"],["mat-flat-button","",1,"carriage__form__button",3,"click","disabled"],[3,"carriage","isDisabled",4,"ngIf"],[1,"form__error"],[3,"carriage","isDisabled"]],template:function(r,i){r&1&&(o(0,"div")(1,"form",0)(2,"div",1)(3,"p",2),g(4,"Name"),a(),m(5,"input",3),o(6,"div",4),d(7,Ae,2,0,"p",5),a()(),o(8,"div",1)(9,"p",2),g(10,"Rows"),a(),m(11,"input",6),o(12,"div",4),d(13,Be,2,0,"p",5),a()(),o(14,"div",1)(15,"p",2),g(16,"Left seats"),a(),m(17,"input",7),o(18,"div",4),d(19,Le,2,0,"p",5),a()(),o(20,"div",1)(21,"p",2),g(22,"Right seats"),a(),m(23,"input",8),o(24,"div",4),d(25,Ue,2,0,"p",5),a()(),o(26,"button",9),w("click",function(){return i.onSave()}),g(27," Save "),a()(),d(28,Ge,1,2,"app-carriage-schema",10),a()),r&2&&(s(),l("formGroup",i.carriageForm),s(6),l("ngIf",i.isDuplicateName),s(6),l("ngIf",(i.rows==null?null:i.rows.invalid)&&(i.rows==null?null:i.rows.touched)&&(i.rows==null?null:i.rows.hasError("max"))),s(6),l("ngIf",(i.leftSeats==null?null:i.leftSeats.invalid)&&(i.leftSeats==null?null:i.leftSeats.touched)&&(i.leftSeats==null?null:i.leftSeats.hasError("max"))),s(6),l("ngIf",(i.rightSeats==null?null:i.rightSeats.invalid)&&(i.rightSeats==null?null:i.rightSeats.touched)&&(i.rightSeats==null?null:i.rightSeats.hasError("max"))),s(),l("disabled",!i.carriageForm.valid),s(2),l("ngIf",i.carriageForm.valid))},dependencies:[_e,me,ce,ge,de,pe,he,fe,ve,xe,$,C,O],styles:[".carriage__form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:30px;width:100%}.carriage__form__field[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:10px}.carriage__form__button[_ngcontent-%COMP%]{margin-top:25px}",".form[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:.9375rem 1.25rem 1.75rem;background-color:#fff;border-radius:5px;box-shadow:2px 2px 2px 1px #828282;width:400px}.form__title[_ngcontent-%COMP%]{font-size:2.5rem;line-height:1.125rem;font-weight:700;margin:2.5rem 0}.form__label[_ngcontent-%COMP%]{margin-left:.625rem;margin-top:1.25rem;font-size:1rem;font-weight:700}.form__field[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form__input[_ngcontent-%COMP%]{appearance:none;border:none;outline:none;border-bottom:2px solid #2169c1;background:#2169c133;border-radius:2px 2px 0 0;padding:.625rem;margin-bottom:.625rem;color:#2169c1}.form__input--error[_ngcontent-%COMP%]{border-bottom:2px solid #ba1a1a}.form__input[_ngcontent-%COMP%]::placeholder{font-size:12px;color:#828282}.form__input-small[_ngcontent-%COMP%]{width:110px}.form__controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;margin-top:20px;gap:8px}.form__link[_ngcontent-%COMP%]{text-decoration:none;color:#2169c1}.form__link[_ngcontent-%COMP%]:hover{color:#000}.form__group[_ngcontent-%COMP%]{width:380px;border-radius:5px;border:1px solid #828282;padding:10px;margin-bottom:20px}.form__tags[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px}.form__icon[_ngcontent-%COMP%]{cursor:pointer}.form__error[_ngcontent-%COMP%]{font-size:.75rem;line-height:.75rem;color:#ba1a1a}.form__error-container[_ngcontent-%COMP%]{min-height:20px}@media (max-width: 425px){.form[_ngcontent-%COMP%]{width:300px}}@media (max-width: 320px){.form[_ngcontent-%COMP%]{width:260px}}"]});let t=e;return t})();var Ve=["panel"],Qe=["*"],Ee=(()=>{let e=class e{constructor(){this.panelService=_(b),this.editMode="create",this.carriageForUpdating=null,this.subscriptions=new G}ngAfterViewInit(){this.subscriptions.add(this.panelService.panelState$.subscribe(n=>{n.panelId==="panel"&&(this.panel.expanded&&n.editMode==="save"?this.panel.close():this.panel.open())}))}ngOnDestroy(){this.subscriptions.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=h({type:e,selectors:[["app-carriages-panel"]],viewQuery:function(r,i){if(r&1&&te(Ve,5),r&2){let p;H(p=A())&&(i.panel=p.first)}},standalone:!0,features:[u],ngContentSelectors:Qe,decls:3,vars:0,consts:[["panel",""],["hideToggle",""]],template:function(r,i){r&1&&(j(),o(0,"mat-expansion-panel",1,0),N(2),a())},dependencies:[Ie,Fe],styles:[".mat-expansion-panel-header.mat-expanded[_ngcontent-%COMP%]{height:0px}.mat-expansion-panel[_ngcontent-%COMP%]{width:100%}"]});let t=e;return t})();function qe(t,e){if(t&1){let c=ee();o(0,"div")(1,"app-create-button",5),w("clickOnButton",function(){Z(c);let r=f();return J(r.openForm())}),a()()}}function We(t,e){t&1&&(o(0,"div",6),m(1,"mat-spinner"),a())}function Ze(t,e){if(t&1&&(o(0,"div",6)(1,"p"),g(2),v(3,"async"),a()()),t&2){let c=f();s(2),re(S(3,1,c.error$))}}function Je(t,e){t&1&&Y(0)}function Ke(t,e){if(t&1&&(K(0),d(1,Je,1,0,"ng-container",7),X()),t&2){f();let c=ie(15);s(),l("ngTemplateOutlet",c)}}function Xe(t,e){if(t&1&&(o(0,"li"),m(1,"app-carriages-item",9),a()),t&2){let c=e.$implicit;s(),l("item",c)}}function Ye(t,e){if(t&1&&(o(0,"ul"),d(1,Xe,2,1,"li",8),v(2,"async"),a()),t&2){let c=f();s(),l("ngForOf",S(2,1,c.carriages$))}}var ci=(()=>{let e=class e{constructor(){this.carriageFacade=_(E),this.panelService=_(b),this.carriages$=this.carriageFacade.carriage$,this.error$=this.carriageFacade.error$,this.isLoading$=this.carriageFacade.isLoading$,this.formState$=this.panelService.panelState$}openForm(){this.panelService.togglePanel("panel","create")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=h({type:e,selectors:[["app-carriages-page"]],standalone:!0,features:[u],decls:16,vars:20,consts:[["carriages",""],[1,"carriage"],[4,"ngIf"],[3,"editMode","carriageForUpdating"],["class","carriage__spinner",4,"ngIf"],[3,"clickOnButton"],[1,"carriage__spinner"],[4,"ngTemplateOutlet"],[4,"ngFor","ngForOf"],[3,"item"]],template:function(r,i){if(r&1&&(o(0,"div",1),d(1,qe,2,0,"div",2),v(2,"async"),o(3,"app-carriages-panel"),m(4,"app-carriages-form",3),v(5,"async"),v(6,"async"),a(),d(7,We,2,0,"div",4),v(8,"async"),d(9,Ze,4,3,"div",4),v(10,"async"),d(11,Ke,2,1,"ng-container",2),v(12,"async"),v(13,"async"),d(14,Ye,3,3,"ng-template",null,0,ae),a()),r&2){let p,y,I;s(),l("ngIf",((p=S(2,6,i.formState$))==null?null:p.editMode)!=="create"),s(3),l("editMode",((y=S(5,8,i.formState$))==null?null:y.editMode)||"create")("carriageForUpdating",((I=S(6,10,i.formState$))==null?null:I.carriage)||null),s(3),l("ngIf",S(8,12,i.isLoading$)),s(2),l("ngIf",S(10,14,i.error$)),s(2),l("ngIf",!S(12,16,i.isLoading$)&&!S(13,18,i.error$))}},dependencies:[Ee,Pe,Oe,le,ye,Se,P,C,se,Me],styles:[".carriage[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:50px}.carriage__spinner[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:center;align-items:center}"]});let t=e;return t})();export{ci as a};
