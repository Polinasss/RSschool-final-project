import{d as u,e as A,f as S,r as l,t as x,w as m,x as L}from"./chunk-MGBRLVRV.js";import{a as b}from"./chunk-PMXBU2MZ.js";import{a as i,b as c,na as v,o as d,sa as I}from"./chunk-LLXA3JIY.js";var P={trip:{routes:[],from:void 0,to:void 0},isLoading:!1,error:null};var f=A({source:"SEARCH",events:{loadTrip:u(),loadTripSuccess:u(),loadTripFailure:u(),getRoutes:S(),getAvailableDates:S(),getRoutesByStartTime:u()}});var O=x({name:"search",reducer:L(P,m(f.loadTrip,t=>c(i({},t),{isLoading:!0})),m(f.loadTripSuccess,(t,{trip:e})=>c(i({},t),{trip:i({},e),isLoading:!1})),m(f.loadTripFailure,(t,{error:e})=>c(i({},t),{error:e.message,isLoading:!1}))),extraSelectors:({selectTrip:t})=>{let e=l(t,s=>s.routes),T=s=>l(t,o=>{let n=[];return o.routes.forEach(a=>{let p=[],h=-1;o.from?.stationId&&(h=a.path.indexOf(o.from?.stationId),h&&h>0&&a.schedule.forEach(g=>{new Date(g.segments[h].time[0]).setHours(0,0,0,0)===s.setHours(0,0,0,0)&&n.push(c(i({},a),{schedule:[...p,g]}))}))}),n}),r=l(t,s=>{let o=[];return s.routes.forEach(n=>{let a=-1;s.from?.stationId&&(a=n.path.indexOf(s.from?.stationId),a&&a>0&&n.schedule.forEach(p=>{o.push(p.segments[a].time[0])}))}),o});return{selectRoutes:e,selectRoutesByStartDay:T,selectAvailableDates:r}}});var $=(()=>{let e=class e{constructor(r){this.http=r,this.filterIsActive=new d(!1),this.tripSearchParams=new d({fromLatitude:0,fromLongitude:0,toLatitude:0,toLongitude:0,time:new Date().toISOString()}),this.filterIsActive$=this.filterIsActive.asObservable(),this.tripSearchParams$=this.tripSearchParams.asObservable()}setFilterActiveState(r){this.filterIsActive.next(r)}setSearchParams(r){this.tripSearchParams.next(r)}getSearchParams(){return this.tripSearchParams.value}getStations(){return this.http.get("/api/station/")}searchStations(r){return this.http.get("/api/search",{params:i({},r)})}};e.\u0275fac=function(s){return new(s||e)(I(b))},e.\u0275prov=v({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{$ as a,f as b,O as c};
